/*! jQuery.mousewheel.js Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net) MIT License
 * Version: 3.0.6 Requires: 1.2.2+ */
(function(d){function e(a){var b=a||window.event,c=[].slice.call(arguments,1),f=0,e=0,g=0;a=d.event.fix(b);a.type="mousewheel";b.wheelDelta&&(f=b.wheelDelta/120);b.detail&&(f=-b.detail/3);g=f;void 0!==b.axis&&b.axis===b.HORIZONTAL_AXIS&&(g=0,e=-1*f);void 0!==b.wheelDeltaY&&(g=b.wheelDeltaY/120);void 0!==b.wheelDeltaX&&(e=-1*b.wheelDeltaX/120);c.unshift(a,f,e,g);return(d.event.dispatch||d.event.handle).apply(this,c)}var c=["DOMMouseScroll","mousewheel"];if(d.event.fixHooks)for(var h=c.length;h;)d.event.fixHooks[c[--h]]= d.event.mouseHooks;d.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=c.length;a;)this.addEventListener(c[--a],e,!1);else this.onmousewheel=e},teardown:function(){if(this.removeEventListener)for(var a=c.length;a;)this.removeEventListener(c[--a],e,!1);else this.onmousewheel=null}};d.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(jQuery);

/* jQuery UI Virtual Keyboard Extensions ~ https://github.com/Mottie/Keyboard * By Rob Garrison ~ MIT license */
/* Autocomplete v1.5 for Keyboard v1.18+ only (3/1/2014) */
(function(d){d.fn.addAutocomplete=function(){return this.each(function(){var a=d(this).data("keyboard");a&&(a.autocomplete_new_version=function(a){a[0]=parseInt(a[0],10);return 1<a[0]||1===a[0]&&9<=parseInt(a[1],10)}(d.ui.version.split(".")),a.autocomplete_init=function(b,c,d){a.options.alwaysOpen&&a.isVisible()&&a.autocomplete_setup();a.$el.bind("visible.keyboard",function(){a.autocomplete_setup()}).bind("change.keyboard",function(){a.hasAutocomplete&&a.isVisible()&&a.$el.val(a.$preview.val()).trigger("keydown.autocomplete")}).bind("hidden.keyboard", function(b){a.$el.autocomplete("close")}).bind("autocompleteopen",function(b,c){a.hasAutocomplete&&a.$autocomplete.menu.element.position({of:a.$keyboard,my:"right top",at:"left top",collision:"flip"})}).bind("autocompleteselect",function(b,c){var d=c.item.value;a.hasAutocomplete&&""!==d&&(a.$preview.val(d).focus(),a.lastCaret={start:d.length,end:d.length})})},a.autocomplete_setup=function(){a.$autocomplete=a.$el.data("autocomplete")||a.$el.data("uiAutocomplete");a.hasAutocomplete="undefined"===typeof a.$autocomplete? !1:a.$autocomplete.options.disabled?!1:!0;a.hasAutocomplete&&(a.$preview.bind("keydown",function(b){return a.autocomplete_input(b)}),a.$allKeys.bind("mouseup mousedown mouseleave touchstart touchend touchcancel",function(b){a.autocomplete_input(b)}))},a.autocomplete_input=function(b){var c;c=d.ui.keyCode;switch(b.keyCode){case c.PAGE_UP:a.$autocomplete._move("previousPage",b);b.preventDefault();break;case c.PAGE_DOWN:a.$autocomplete._move("nextPage",b);b.preventDefault();break;case c.UP:a.$autocomplete._move("previous", b);b.preventDefault();break;case c.DOWN:a.$autocomplete._move("next",b);b.preventDefault();break;case c.ENTER:case c.NUMPAD_ENTER:c=a.$autocomplete.menu.element.find("#ui-active-menuitem,.ui-state-focus").text()||"";""!==c&&a.$preview.val(c);a.autocomplete_new_version&&a.$autocomplete.menu.select(b);break;default:clearTimeout(a.$autocomplete.searching),a.$autocomplete.searching=setTimeout(function(){a.$autocomplete.term!==a.$autocomplete.element.val()&&(a.$autocomplete.selectedItem=null,a.$autocomplete.search(null, b))},a.$autocomplete.options.delay)}},a.origEscClose=a.escClose,a.escClose=function(b){a.hasAutocomplete&&("ui-active-menuitem"===b.target.id||d(b.target).closest("ul").hasClass("ui-autocomplete"))||a.origEscClose(b)},a.autocomplete_init())})}})(jQuery);

/* jQuery Mobile Themes v1.1 for keyboard v1.18+ (updated 3/1/2014) */
(function(b){b.fn.addMobile=function(e){var c,f={container:{theme:"a"},buttonMarkup:{theme:"a",shadow:"true",corners:"true"},buttonHover:{theme:"c"},buttonAction:{theme:"b"},buttonActive:{theme:"e"}};return this.each(function(){var a=b(this).data("keyboard");a&&"undefined"!==typeof b.fn.textinput&&(a.mobile_options=c=b.extend({},f,e),a.mobile_init=function(){b(".ui-keyboard-input").textinput();a.options.alwaysOpen&&a.isVisible&&a.mobile_setup();a.$el.on("beforeVisible.keyboard",function(){a.$keyboard.css("visibility", "hidden")}).on("visible.keyboard",function(){a.mobile_setup();a.$keyboard.css("visibility","visible");a.$preview.focus()})},a.mobile_setup=function(){var d;d=b.extend({},c.buttonMarkup,c.buttonAction);a.$keyboard.addClass("ui-bar ui-bar-"+c.container.theme).removeClass("ui-widget ui-widget-content").find("button:not(."+a.options.css.buttonAction+")").addClass(a.modButton(c.buttonMarkup)).end().find("."+a.options.css.buttonAction).addClass(a.modButton(d)).end().find("button").removeClass("ui-corner-all ui-state-default").hover(function(){b(this).addClass("ui-btn-hover-"+ c.buttonHover.theme)},function(){b(this).removeClass("ui-btn-hover-"+c.buttonHover.theme)});a.options.css.buttonAction="ui-btn-down-"+c.buttonActive.theme;a.msie&&a.$preview[0]!==a.el&&(a.$preview.hide(),a.$keyboard.css("width",""),a.width=a.$keyboard.outerWidth(),a.$keyboard.width(a.width+parseInt(a.$preview.css("fontSize"),10)),a.$preview.width(a.width),a.$preview.show());d=a.options.position;d.of=d.of||a.$el.data("keyboardPosition")||a.$el;d.collision=a.options.usePreview?d.collision||"fit fit": "flip flip";a.$keyboard.position(d)},a.modButton=function(a){return"ui-btn ui-btn-up-"+a.theme+" ui-btn-"+a.theme+("true"==a.shadow?" ui-shadow":"")+("true"==a.corners?" ui-btn-corner-all":"")},a.mobile_init())})}})(jQuery);

/* Navigation v1.4 for Keyboard v1.18+ only (updated 3/1/2014) */
(function(e){e.keyboard=e.keyboard||{};e.keyboard.navigationKeys={toggle:112,enter:13,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,caretrt:45,caretlt:46};e.fn.addNavigation=function(n){return this.each(function(){var c,k,a=e(this).data("keyboard");k={position:[0,0],toggleMode:!1,focusClass:"hasFocus"};a&&(a.navigation_options=c=e.extend({},k,n),a.navigation_keys=k=e.extend({},e.keyboard.navigationKeys),a.saveNav=[a.options.tabNavigation,a.options.enterNavigation],a.allNavKeys= e.map(k,function(a,b){return a}),a.navigation_init=function(){a.$keyboard.toggleClass(c.focusClass,c.toggleMode).find(".ui-keyboard-keyset:visible").find('.ui-keyboard-button[data-pos="'+c.position[0]+","+c.position[1]+'"]').addClass("ui-state-hover");a.$preview.unbind("keydown.keyboardNav").bind("keydown.keyboardNav",function(c){return a.checkKeys(c.which)})},a.checkKeys=function(h,b){if("undefined"!==typeof h){var d=a.navigation_keys;if(h===d.toggle||b)c.toggleMode=b?!1:!c.toggleMode,a.options.tabNavigation= c.toggleMode?!1:a.saveNav[0],a.options.enterNavigation=c.toggleMode?!1:a.saveNav[1];a.$keyboard.toggleClass(c.focusClass,c.toggleMode);if(c.toggleMode&&h===d.enter)return a.$keyboard.find(".ui-keyboard-keyset:visible").find('.ui-keyboard-button[data-pos="'+c.position[0]+","+c.position[1]+'"]').trigger("repeater.keyboard"),!1;if(c.toggleMode&&0<=e.inArray(h,a.allNavKeys))return a.navigateKeys(h),!1}},a.navigateKeys=function(h,b,d){d=d||c.position[1];b=b||c.position[0];var e=a.$keyboard.find(".ui-keyboard-keyset:visible"), k=e.find(".ui-keyboard-button-endrow").length-1,l=e.find('.ui-keyboard-button[data-pos^="'+b+',"]').length-1,g=a.lastCaret,m=a.$preview.val().length,f=a.navigation_keys;switch(h){case f.pageup:b=0;break;case f.pagedown:b=k;break;case f.end:d=l;break;case f.home:d=0;break;case f.left:d+=0<d?-1:0;break;case f.up:b+=0<b?-1:0;break;case f.right:d+=1;break;case f.down:b+=b+1>k?0:1;break;case f.caretRt:g.start++;break;case f.caretLt:g.start--}if(h===f.caretRt||h===f.caretLt)g.start=0>g.start?0:g.start> m?m:g.start,g.end=g.start,a.lastCaret=g,a.$preview.focus().caret(g.start,g.start);l=e.find('.ui-keyboard-button[data-pos^="'+b+',"]').length-1;d>l&&(d=l);e.find(".ui-state-hover").removeClass("ui-state-hover");e.find('.ui-keyboard-button[data-pos="'+b+","+d+'"]').addClass("ui-state-hover");c.position=[b,d]},a.options.alwaysOpen&&a.isVisible&&(a.$keyboard.find(".ui-state-hover").removeClass("ui-state-hover"),a.navigation_init()),a.$el.bind("visible.keyboard",function(c){a.$keyboard.find(".ui-state-hover").removeClass("ui-state-hover"); a.navigation_init()}).bind("inactive.keyboard hidden.keyboard",function(c){a.checkKeys(c.which,!0)}).bind("navigate navigateTo",function(c,b,d){b=isNaN(b)?b.toLowerCase():b;a.navigation_keys.hasOwnProperty(b)?a.checkKeys(a.navigation_keys[b]):a.navigateKeys(null,b,d)}))})}})(jQuery);

/* Scramble Extension v1.1 for Keyboard v1.18+ (updated 3/1/2014) */
(function(b){b.keyboard=b.keyboard||{};b.fn.addScramble=function(s){var t={targetKeys:/[a-z\d]/i,byRow:!0,randomizeOnce:!0};return this.each(function(){var h,a=b(this).data("keyboard");a&&(h=a.scramble_options=b.extend({},t,s),a.scramble_setup=function(f){var r,k,e,c,p,l,g,n,q,m,d;r=f.find(".ui-keyboard-keyset");if(f.length){for(k=0;k<r.length;k++)if(e=r.eq(k),g=0,d=[],q=[],n=[],m=[],e.children("button, span, br").each(function(){"BR"===this.tagName?(h.byRow?(d.push(this),q.push(!1),m[g]=d,n[g]=q, d=[],q=[]):(m[g]=this,n[g]=!1),g++):(l=b(this).attr("data-value")||"",l=1===l.length&&h.targetKeys.test(l)?l:!1,h.byRow?(d.push(this),q.push(l)):(m[g]=this,n[g]=l,g++))}),e.find(".ui-keyboard-button-endrow").remove(),h.byRow)for(p=0;p<m.length;p++)for(d=a.shuffle(m[p],n[p]),c=0;c<d.length;c++)e.append(d[c]);else for(d=a.shuffle(m,n),c=0;c<d.length;c++)e.append(d[c]);return f}},a.shuffle=function(a,b){for(var k,e,c=a.length;0<c;)e=Math.floor(Math.random()*c),!1===b[c-1]&&c--,!1!==b[c-1]&&!1!==b[e]&& (c--,k=a[c],a[c]=a[e],a[e]=k);return a},a.options.create=function(){var f=a.options.layout;b.keyboard.builtLayouts[f]={mappedKeys:{},acceptedKeys:[],$keyboard:null};"undefined"===typeof b.keyboard.builtLayouts[a.orig_layout]&&(a.layout=a.options.layout=a.orig_layout,a.buildKeyboard(),a.layout=a.options.layout=f);b.keyboard.builtLayouts[f]=b.extend({},b.keyboard.builtLayouts[a.orig_layout]);h.randomizeOnce&&(b.keyboard.builtLayouts[f].$keyboard=a.scramble_setup(b.keyboard.builtLayouts[a.orig_layout].$keyboard.clone())); a.$keyboard=b.keyboard.builtLayouts[f].$keyboard;h.randomizeOnce||a.$el.bind("beforeVisible.keyboard",function(a,b){b.$keyboard=b.scramble_setup(b.$keyboard)})},a.orig_layout=a.options.layout,a.options.layout="scrambled"+Math.round(1E4*Math.random()))})}})(jQuery);

/* Typing Simulator v1.4 for Keyboard v1.18+ only (3/1/2014) */
(function(g){g.fn.addTyping=function(k){var l={showTyping:!0,delay:250};return this.each(function(){var a=g(this).data("keyboard");a&&(a.typing_options=g.extend({},l,k),a.typing_keymap={" ":"space",'"':"34","'":"39","&nbsp;":"space","\b":"bksp","\n":"Enter","\r":"Enter","\t":"tab"},a.typing_xref={8:"bksp",9:"tab",13:"enter",32:"space"},a.typing_event=!1,a.typing_setup=function(){(a.$preview?a.$preview:a.$el).bind("keyup.keyboard",function(b){37<=b.which&&40>=b.which||(16===b.which&&(a.shiftActive= !1),18===b.which&&(a.altActive=!1),16!==b.which&&18!==b.which)||(a.showKeySet(),setTimeout(function(){a.$preview.focus()},200))}).bind("keydown.keyboard",function(b){b.temp=!1;16===b.which&&(b.temp=a.shiftActive?!1:!0,a.shiftActive=!0);18===b.which&&(b.temp=a.altActive?!1:!0,a.altActive=!0);b.temp&&(a.showKeySet(),a.$preview.focus());a.typing_event=!0;8!==b.which&&9!==b.which||a.typeIn("",a.typing_options.delay||250,function(){a.typing_event=!1},b)}).bind("keypress.keyboard",function(b){a.typing_event&& !a.options.lockInput&&a.typeIn("",a.typing_options.delay||250,function(){a.typing_event=!1},b)})},a.typeIn=function(b,e,f,c){if(a.isVisible()){var d=a.typing_options,h=g.keyboard.builtLayouts[a.layout].mappedKeys;!0!==a.typing_options.init&&(d.init=!0,d.text=b,d.len=b.length,d.delay=e||300,d.current=0,d.callback=f);b=d.text.substring(d.current,++d.current);e=a.$keyboard.find(".ui-keyboard-keyset");f='.ui-keyboard-button[data-value="'+(a.typing_keymap.hasOwnProperty(b)?a.typing_keymap[b]:b)+'"]';a.typing_event&& c&&(a.typing_xref.hasOwnProperty(c.keyCode||c.which)?f=".ui-keyboard-"+a.typing_xref[c.keyCode||c.which]:(f=String.fromCharCode(c.charCode||c.which),f=h.hasOwnProperty(f)?'.ui-keyboard-button[data-value="'+h[f]+'"]':".ui-keyboard-"+(c.charCode||c.which)));c=e.filter(":visible").find(f);c.length?a.typing_simulateKey(c,b):(a.typing_event?c=e.find(f):(c=a.typing_keymap.hasOwnProperty(b)?a.typing_keymap[b]:b.charCodeAt(0),"bksp"===c&&(b=c),c=e.find(".ui-keyboard-"+c)),e=c.closest(".ui-keyboard-keyset"), e.attr("name")?(e=e.attr("name"),a.shiftActive=/shift/.test(e),a.altActive=/alt/.test(e),a.metaActive=a.lastKeyset[2]=e.match(/meta\d+/)||!1,a.showKeySet({name:a.metaActive}),a.typing_simulateKey(c,b)):a.typing_event||(a.insertText(b),a.checkCombos()));d.current<d.len?a.isVisible()&&setTimeout(function(){a.typeIn()},d.delay):(d.init=!1,g.isFunction(d.callback)&&setTimeout(function(){d.callback(a)},d.delay))}else a.typing_options.init=!1,clearTimeout(a.typing_timer)},a.typing_simulateKey=function(b, e){var f=b.length;f&&b.filter(":visible").trigger("mouseenter.keyboard");a.typing_timer=setTimeout(function(){f&&setTimeout(function(){b.trigger("mouseleave.keyboard")},a.typing_options.delay/3);a.isVisible()&&!a.typing_event&&(a.insertText(e),a.checkCombos())},a.typing_options.delay/3)},a.typing_options.showTyping&&(a.options.alwaysOpen&&a.isVisible()&&a.typing_setup(),a.$el.bind("visible.keyboard",function(){a.typing_setup()})))})}})(jQuery);
